# SELab3 (BDD)
تمرین سوم آزمایشگاه مهندسی نرم‌افزار - تابستان ۱۴۰۲

*امیر معینی، سارا آذرنوش*

# بخش اول

با اجرای فیچر `Calculator`
بعد از اضافه کردن
`Scenario Outline`
جدید، خطای زیر را مشاهده می‌کنیم:

![Alt text](<assets/Screenshot from 2023-08-04 19-26-00.png>)

همانطور که می‌بینیم در تست زیر

```feature
| -1    | 6      | 5  	    |
```
به مشکل خورده‌ایم.

دلیل آن نیز از ارور مشخص است، چون که ‍‍
`1-`
در عبارت رجکس زیر که برای `Stepdef` مورد نظرمان تعریف کرده‌ایم، تشخیص داده نمی‌شود، ‍cucumber هیچ `step` ای برای `Given`
این تست پیدا نمی‌کند و ارور می‌دهد.

![Alt text](<assets/Screenshot from 2023-08-04 19-34-42.png>)

برای حل این مشکل دو راه داریم. می‌توانیم عبارت رجکش را اصلاح کنیم تا علامت منفی را تشخیص دهد:

```regex
^Two input values, (-?\\d+) and (-?\\d+)$
```
یا اینکه از
[Cucumber Expressions](https://github.com/cucumber/cucumber-expressions#readme)
استفاده کنیم(همانطور که در قسمت دوم ارور به ما پیشنهاد شده‌است):


```java
@Given("Two input values, {int} and {int}")
```
```java
@Then("I expect the result {int}")
```

حال برای پوشش یک حالت جا افتاده، یک تست دیگر که حاصل آن منفی است نیز اضافه می‌کنیم و دوباره اجرا می‌کنیم:

![Alt text](<assets/Screenshot from 2023-08-04 19-49-19.png>)

![Alt text](<assets/Screenshot from 2023-08-04 19-49-46.png>)

همانطور که می‌بینیم، تمام تست‌ها با موفقیت پاس شدند.

کد این بخش در تگ `part-one`
تکمیل شده‌است.

# بخش دوم

ابتدا فیچر‌های ماشین حساب را در قالب سناریو‌هایی تعریف می‌کنیم. دو `Scenario Outline`
استفاده می‌کنیم. اولی
`Calculate valid expressions`
است که در آن قابلیت‌های محاسباتی را از لحاظ صحیح بودن خروجی می‌سنجیم. دومی
`Calculate invalid expressions`
است که قابلیت‌های Exception handling
ماشین‌حساب را در مواجهه با ورودی‌های نادرست می‌سنجیم. دقت کنیم که ورودی‌های نادرست در signature
تابع `calculate`
صدق می‌کنند ولی در ادامه به مشکل بر‌میخورند و ماشین‌حساب باید Exception با پیام مناسب را throw کند.

سپس Step definition ها مورد نیاز را می‌نویسیم. در نوشتن این کد از
Cucumber expressionها برای راحتی کار استفاده می‌کنیم.

اکنون اگر این فیچر را تست کنیم، هیچکدام از تست‌ها پاس نمی‌شوند. پس شروع می‌کنیم به نوشتن کد ماشین‌حساب. پس نوشتن آن دوباره تست‌ها را اجرا می‌کنیم و پس از اندکی دیباگ کردن قسمت‌های مختلف، به حالتی می‌رسیم که تمام تست‌ها درست هستند:

![Alt text](<assets/Screenshot from 2023-08-04 21-51-09.png>)

در پایان، برای اینکه بتوانیم ماشین‌حساب را اجرا نیز بکنیم، یک رابط کاربری ساده که ورودی را در ترمینال می‌گیرد در کلاس
`Parser`
می‌نویسیم و با استفاده از آن می‌توانیم در ترمینال با ماشین حسابمان کار کنیم:

![Alt text](<assets/Screenshot from 2023-08-04 21-55-12.png>)
